labs(x = "Value", y = "Height",
title = "Step: {closest_state}")
g %>% ggplot() +
geom_col(aes(x= factor(x), y = factor(a))) +
transition_states(i,
transition_length = 0,
state_length      = 1,
wrap              = FALSE) +
shadow_mark(past = TRUE, future = FALSE) +
geom_line(aes(x=factor(x), y= factor(l)), color = "red", group = 1) +
labs(x = "Value", y = "Height",
title = "Step: {closest_state}")
# build plot + transition + shadow
p <- ggplot(g, aes(x = x, y = l)) +
#geom_line(color = "red", size = 1)  +
ggplot(g, aes(x = x, y = a)) +
geom_col(fill = "steelblue") +
transition_states(i,
transition_length = 0,
state_length      = 1,
wrap              = FALSE) +
shadow_mark(past = TRUE, future = FALSE) +
labs(x = "Value", y = "Height",
title = "Step: {closest_state}")
# build plot + transition + shadow
p <-
ggplot(g, aes(x = x, y = a)) +
geom_col(fill = "steelblue") +
transition_states(i,
transition_length = 0,
state_length      = 1,
wrap              = FALSE) +
shadow_mark(past = TRUE, future = FALSE) +
labs(x = "Value", y = "Height",
title = "Step: {closest_state}")
p
g %>% ggplot() +
geom_col(aes(x= x, y = a)) +
geom_line(aes(x= x, y= l), color = "red", group = 1) +
labs(x = "Value", y = "Height",
title = "Step: {closest_state}")
library(ggplot2)
library(gganimate)
library(gifski)
# Data frame: x = years, a = bar heights, l = line values, i = frame index
```r
g <- data.frame(
x = 2021:2025,
a = c(5, 10, 15, 20, 25),   # bar heights
l = c(10,10,10,19,24),      # line values
i = 1:5                     # animation order
)
p <- ggplot(g, aes(x = factor(x))) +
geom_col(aes(y = a), fill = "steelblue") +
geom_line(data = g, aes(x = factor(x), y = l, group = 1), color = "red", size = 1) +
transition_manual(i) +
shadow_mark(past = TRUE, future = FALSE) +
shadow_path(past = TRUE, future = FALSE) +
labs(x = "Year",
y = "Value",
title = "Year: {current_frame}") +
theme_minimal()
library(ggplot2)
library(gganimate)
library(gifski)
g <- data.frame(
x = 2021:2025,
a = c(5, 10, 15, 20, 25),   # bar heights
l = c(10,10,10,19,24),      # line values
i = 1:5                     # animation order
)
p <- ggplot(g, aes(x = factor(x))) +
geom_col(aes(y = a), fill = "steelblue") +
geom_line(data = g, aes(x = factor(x), y = l, group = 1), color = "red", size = 1) +
transition_manual(i) +
shadow_mark(past = TRUE, future = FALSE) +
shadow_path(past = TRUE, future = FALSE) +
labs(x = "Year",
y = "Value",
title = "Year: {current_frame}") +
theme_minimal()
??shadow_path
library(ggplot2)
library(gganimate)
library(gifski)
# Data frame: years (x), bar heights (a), line values (l), frame index (i)
g <- data.frame(
x = 2021:2025,
a = c(5, 10, 15, 20, 25),   # bar heights
l = c(10, 10, 10, 19, 24),   # static line values
i = 1:5                     # animation order
)
# Plot definition:
p <- ggplot(g, aes(x = factor(x))) +
# 1) Static red line, drawn from full dataset
geom_line(data = g,
aes(x = factor(x), y = l, group = 1),
color = "red", size = 1) +
# 2) Bars that accumulate via shadow_mark()
geom_col(aes(y = a), fill = "steelblue") +
# 3) One frame per 'i'
transition_manual(i) +
# 4) Retain all past bars
shadow_mark(past = TRUE, future = FALSE) +
# 5) Labels and theme
labs(x = "Year",
y = "Value",
title = "Year: {current_frame}") +
theme_minimal()
# Render a looping GIF
gif_animation <- animate(
p,
fps      = 1,                              # one frame per year
nframes  = nrow(g),                        # total frames = number of rows
renderer = gifski_renderer(loop = TRUE)    # loop forever
)
# Display in RStudio Viewer
gif_animation
####### ONE LAST TRY
# Animated bar chart with static red reference line
# Bars appear one by one and loop; the red line is drawn statically behind the bars.
library(ggplot2)
library(gganimate)
library(gifski)
# 1) Data frame: years, bar heights, line values, animation order
g <- data.frame(
year = 2021:2025,
bar  = c(5, 10, 15, 20, 25),
line = c(10, 10, 10, 19, 24),
frame = 1:5
)
# 2) Plot definition:
p <- ggplot(g, aes(x = factor(year))) +
# Static red reference line drawn from full data
geom_line(data = g,
aes(x = factor(year), y = line, group = 1),
color = "red", size = 1) +
# Bars that appear and accumulate
geom_col(aes(y = bar), fill = "steelblue") +
# One frame per 'frame' value, no tween
transition_states(frame,
transition_length = 0,
state_length      = 1,
wrap              = FALSE) +
# Retain all past bars
shadow_mark(past = TRUE, future = FALSE) +
labs(x     = "Year",
y     = "Value",
title = "Year: {closest_state}") +
theme_minimal()
# 3) Animate with a loop
gif <- animate(
p,
fps      = 1,
nframes  = nrow(g),
renderer = gifski_renderer(loop = TRUE)
)
# Display it in RStudio Viewer
gif
k <- ggplot(g, aes(x = factor(year))) +
# Static red reference line drawn from full data
geom_line(data = g,
aes(x = factor(year), y = line, group = 1),
color = "red", size = 1)
k
library(ggplot2)
library(gganimate)
library(gifski)
# your toy data
g <- data.frame(
a = c(5, 10, 15, 20, 25), #values of bars
i = c(1, 2, 3, 4, 5), #order bars will appear
l = c(10, 10, 10, 19, 24),
x = c(2021, 2022, 2023, 2024, 2025)
)
# build plot + transition + shadow
p <-  #WORKS: bar chart with animation - bars appear one-by-one and then loop.
ggplot(g, aes(x = x, y = a)) +
geom_col(fill = "steelblue") +
transition_states(i,
transition_length = 0,
state_length      = 1,
wrap              = FALSE) +
shadow_mark(past = TRUE, future = FALSE) +
labs(x = "Value", y = "Height",
title = "Step: {closest_state}")
p #print
??transition_states
data <- data.frame(
year = c(2018, 2017, 2016, 2015, 2014),
price = c(3185.96, 3249.69, 3005.24, 3739.79, 2238.22),
profit = c(9, 10, 6, 17, 15)
)
library(ggplot2)
p1 <- ggplot(data) + geom_bar(aes(year, price, fill = year), stat = 'identity') +
geom_line(aes(year, profit*100)) +
scale_y_continuous(name = 'Price',sec.axis = sec_axis(~./100, 'Profit%'))
p1
long <- pivot_longer(data, -year, names_to = 'Category', values_to = 'Value')
??pivot_longer
library(tidyr)
long <- pivot_longer(data, -year, names_to = 'Category', values_to = 'Value')
View(data)
View(long)
p2 <- ggplot(long, aes(year, Value)) + facet_grid(Category~., scales = 'free') +
geom_bar(data = long[long$Category == 'price', ], stat = 'identity') +
geom_line(data = long[long$Category == 'profit', ])
p2
library(gganimate)
#animate them overlaid
data %>%
ggplot(aes(year, price, fill = year)) +
geom_bar(stat = 'identity') +
geom_line(aes(year, profit*100)) +
scale_y_continuous(name = 'Price',
sec.axis = sec_axis(~./100, 'Profit%')) +
transition_manual(year, cumulative = TRUE)
??geom_bar()
# your toy data
g <- data.frame(
a = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
l = c(10, 10, 10, 19, 24), #for eventual line
x = c(2021, 2022, 2023, 2024, 2025) #x-axis
)
# your toy data
dat <- data.frame(
enr = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
est = c(10, 10, 10, 19, 24), #for eventual line
year = c(2021, 2022, 2023, 2024, 2025) #x-axis
)
??scale_y_continuous
## STACK overflow attempt
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
scale_y_continuous(name = 'Price',
sec.axis = sec_axis('Projected')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## STACK overflow attempt
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
scale_y_continuous(name = 'Price',
sec.axis = sec_axis('est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## STACK overflow attempt
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
scale_y_continuous(name = 'Price',
sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## STACK overflow attempt
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
# install.packages(c("ggplot2","gganimate","tidyr"))
library(ggplot2)
library(gganimate)
library(tidyr)
# install.packages(c("ggplot2","gganimate","tidyr"))
library(ggplot2)
library(gganimate)
library(tidyr)
dat <- data.frame(
enr = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
est = c(10, 10, 10, 19, 24), #for eventual line
year = c(2021, 2022, 2023, 2024, 2025) #x-axis
)
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(shape = shape), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
dat + theme(panel.background = element_rect(fill = "white", colour = "grey50"))
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE)
theme <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = "gray")) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE) +
theme
dat <- data.frame(
enr = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
est = c(10, 10, 10, 19, 24), #for eventual line
year = c(2021, 2022, 2023, 2024, 2025), #x-axis
barcolor = c("gray", "gray", "lightblue", "lightblue", "lightblue")
)
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = barcolor)) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE) +
theme
dat <- data.frame(
enr = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
est = c(10, 10, 10, 19, 24), #for eventual line
year = c(2021, 2022, 2023, 2024, 2025), #x-axis
barcolor = c("grey", "grey", "lightblue", "lightblue", "lightblue")
)
theme <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = barcolor)) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE) +
theme
dat <- data.frame(
enr = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
est = c(10, 10, 10, 19, 24), #for eventual line
year = c(2021, 2022, 2023, 2024, 2025), #x-axis
barcolor = c("azure2", "azure2", "lightblue", "lightblue", "lightblue")
)
theme <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = barcolor)) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE) +
theme
dat <- data.frame(
enr = c(5, 10, 15, 20, 25), #values of bars - y-axis
i = c(1, 2, 3, 4, 5), #order bars will appear
est = c(10, 10, 10, 19, 24), #for eventual line
year = c(2021, 2022, 2023, 2024, 2025), #x-axis
barcolor = c("azure2", "azure2", "cadetblue3", "cadetblue3", "cadetblue3")
)
theme <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(year, enr, fill = barcolor)) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE) +
theme
## WORKS - bar and line animate overlaid
#based on a stack overflow post: https://stackoverflow.com/questions/58830811/animate-plot-containing-both-bar-and-line-plots-using-r
dat %>%
ggplot(aes(x = year, y = enr, fill = barcolor)) + #aes(x-axis, y-axis, fill color)
geom_bar(stat = 'identity') + #specifies the stat layer - not totally clear what this is!
geom_line(aes(year, est)) + #aes(x-axis, y-axis for line)
geom_point(aes(year, est, shape = "circle"), size = 5, fill = "red") +
scale_y_continuous(name = 'Price') + #,
#sec.axis = sec_axis(NULL, 'est')) + #sec_axis(~./100, 'Profit%')) + #creates the secondary y-axis
transition_manual(year, cumulative = TRUE) +
theme
# Fixing bar colors with `scale_fill_identity()`
library(ggplot2)
library(gganimate)
# Your data
dat <- data.frame(
enr = c(5, 10, 15, 20, 25),            # bar heights
est = c(10, 10, 10, 19, 24),            # line values
year = 2021:2025,                       # x-axis
barcolor = c("azure2", "azure2",      # first two light gray
"cadetblue3", "cadetblue3", "cadetblue3")  # rest light blue
)
# Clean theme
my_theme <- theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
# Plot
p <- dat %>%
ggplot(aes(x = year, y = enr, fill = barcolor)) +
geom_col() +                              # identity stat for bar heights
geom_line(aes(y = est), color = "red", size = 1) +
geom_point(aes(y = est), shape = 21,      # filled circle
size = 5, fill = "red") +
scale_fill_identity() +                   # use the values in barcolor directly
scale_x_continuous(breaks = dat$year) +
scale_y_continuous(name = 'Price') +
my_theme
# Animate
anim <- p +
transition_manual(year, cumulative = TRUE)
# Render (looping GIF)
animate(anim, nframes = length(dat$year), fps = 1, renderer = gifski_renderer(loop = TRUE))
# Fix line grouping so it remains continuous across color changes
library(ggplot2)
library(gganimate)
# Your data
dat <- data.frame(
enr = c(5, 10, 15, 20, 25),            # bar heights
est = c(10, 10, 10, 19, 24),            # line values
year = 2021:2025,                       # x-axis
barcolor = c("azure2", "azure2",      # first two light gray
"cadetblue3", "cadetblue3", "cadetblue3")  # rest light blue
)
# Clean theme
my_theme <- theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")
)
# Plot with explicit grouping for the line
p <- ggplot(dat, aes(x = year, y = enr)) +
# bars with custom colors
geom_col(aes(fill = barcolor)) +
# line continues without breaks by setting group = 1
geom_line(aes(y = est, group = 1), color = "red", size = 1) +
geom_point(aes(y = est), shape = 21, size = 5, fill = "red") +
# use identity scale to apply colors directly
scale_fill_identity() +
scale_x_continuous(breaks = dat$year) +
scale_y_continuous(name = 'Price') +
my_theme +
# animate cumulatively by year
transition_manual(year, cumulative = TRUE)
# Render animation (looping GIF)
animate(p,
nframes = length(dat$year),
fps     = 1,
renderer = gifski_renderer(loop = TRUE))
